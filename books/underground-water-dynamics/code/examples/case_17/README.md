# 案例17：地面沉降模拟

## 系统示意图（AI自动生成）

<table>
<tr>
<td width="58%">
<img src="case_17_ai_diagram.png" alt="案例17：地面沉降模拟系统示意图" width="100%"/>
</td>
<td width="42%">

**AI大模型总结要点**

- 📚 学习目标：通过本案例，你将学会：
- 🎯 物理背景：为什么发生地面沉降？
- 📐 理论基础：Terzaghi有效应力原理
- 💻 代码实现：有效应力计算

> 该图由AI图像生成引擎根据案例描述自动创建，呈现输入条件、物理模型、控制策略与关键指标之间的关系，可作为阅读正文前的快速导览。

</td>
</tr>
</table>



**难度**: ⭐⭐⭐⭐  
**前置案例**: 案例16  
**预计学习时间**: 5-7小时

---

## 📚 学习目标

通过本案例，你将学会：

1. ✅ 理解Terzaghi有效应力原理
2. ✅ 掌握土层压缩计算方法
3. ✅ 理解先期固结概念
4. ✅ 分析固结时间过程
5. ✅ 预测地面沉降
6. ✅ 评估沉降风险

---

## 🎯 物理背景

### 为什么发生地面沉降？

**物理过程**：
```python
地下水开采 → 水位下降 → 孔隙水压力降低
         ↓
有效应力增加 → 土骨架压缩 → 地面沉降
```

**典型案例**：
- **墨西哥城**：沉降超过10m
- **上海**：局部沉降超过3m
- **北京**：累计沉降超过1m
- **天津**：沉降漏斗明显

**危害**：
1. 建筑物损坏（裂缝、倾斜）
2. 地下管线破裂
3. 地表积水排水困难
4. 海水倒灌（沿海地区）
5. 地裂缝

---

## 📐 理论基础

### 1. Terzaghi有效应力原理

**基本原理**（1923）：

土体受到的总应力由两部分承担：
```python
σ = σ' + u

σ: 总应力（土粒+水承担）
σ': 有效应力（仅土粒承担）
u: 孔隙水压力（水承担）
```

**物理意义**：
- 总应力：土体受到的总压力
- 有效应力：土粒间接触力，控制土体变形
- 孔压：孔隙水的压力

**关键结论**：
> 土体的压缩变形由有效应力控制，而非总应力

### 2. 水位下降的影响

**排水条件**（地下水位下降）：

水位下降 Δh → 孔压降低 Δu：
```python
Δu = γw * Δh

γw: 水的重度 ≈ 9.81 kN/m³
```

总应力不变（土柱重量不变）：
```python
Δσ = 0
```

有效应力增加：
```python
Δσ' = Δσ - Δu = 0 - Δu = -Δu

Δσ' = γw * |Δh|  （水位下降时）
```

**数值示例**：
- 水位下降10m → 有效应力增加98.1 kPa
- 水位下降30m → 有效应力增加294.3 kPa

### 3. 土层压缩模型

#### 3.1 线性压缩模型

**适用**：小应力增量

**公式**：
```python
ΔH = av * Δσ' * H

av: 压缩系数 [1/kPa]
H: 土层厚度 [m]
```

**压缩系数av典型值**：
- 砂土：0.0001 ~ 0.0005
- 粉土：0.0003 ~ 0.001
- 粘土：0.0005 ~ 0.003
- 淤泥：0.001 ~ 0.01

#### 3.2 对数压缩模型

**适用**：大应力范围

**e-logσ'直线关系**：
```python
e = e0 - Cc * log10(σ' / σ'0)

e: 孔隙比
Cc: 压缩指数
```

**压缩量**：
```python
ΔH/H = Δε = Cc / (1+e0) * log10(σ'f / σ'0)
```

**压缩指数Cc典型值**：
- 粘土：0.1 ~ 0.5
- 淤泥：0.5 ~ 1.5
- 有机质土：> 2.0

### 4. 先期固结

**定义**：
- **先期固结压力** σ'c：土层历史上经历过的最大有效应力
- **超固结比** OCR = σ'c / σ'0

**分类**：
1. **正常固结** (OCR = 1)：
   - 当前应力 = 历史最大应力
   - 从未被更大应力压过
   - 压缩性大

2. **超固结** (OCR > 1)：
   - 当前应力 < 历史最大应力
   - 曾被更大应力压过（如冰川、剥蚀）
   - 压缩性小

**压缩行为**：
```python
σ'0 → σ'c: 再压缩（Cs, 小压缩）
σ'c → σ'f: 正常压缩（Cc, 大压缩）

Cs: 回弹指数 ≈ Cc/5
```

### 5. 固结时间过程

**Terzaghi一维固结方程**：
```python
∂u/∂t = Cv * ∂²u/∂z²

u: 超孔隙水压力
Cv: 固结系数 [m²/day]
```

**固结系数**：
```python
Cv = k / (γw * mv)

k: 渗透系数
mv: 体积压缩系数
```

**平均固结度U(t)**：
```python
U(Tv) = 1 - Σ (2/M²) * exp(-M²Tv)

Tv = Cv*t / H²  (时间因子)
H: 排水距离
```

**简化公式**：
- Tv < 0.2: `U ≈ √(4Tv/π)`
- Tv > 0.2: `U ≈ 1 - 10^(-Tv/0.085)`

**关键时间**：
- U = 50%: Tv = 0.197
- U = 90%: Tv = 0.848

**固结沉降**：
```python
S(t) = U(t) * S_ultimate
```

---

## 💻 代码实现

### 有效应力计算

```python
def compute_effective_stress_change(head_change, gamma_water=9.81):
    """
    Δσ' = -γw * Δh
    """
    delta_sigma = -gamma_water * head_change
    return delta_sigma

# 示例
dh = -30  # 水位下降30m
delta_sigma = compute_effective_stress_change(dh)
print(f"有效应力增加: {delta_sigma:.1f} kPa")  # 294.3 kPa
```python

### 土层类

```python
@dataclass
class SoilLayer:
    """土层"""
    name: str
    top: float
    bottom: float
    av: float = None  # 压缩系数
    Cc: float = None  # 压缩指数
    e0: float = None  # 初始孔隙比
    sigma_c: float = None  # 先期固结压力
    
    def compute_compression_linear(self, delta_sigma):
        """线性压缩"""
        return self.av * delta_sigma * self.thickness
    
    def compute_compression_logarithmic(self, sigma_0, sigma_f):
        """对数压缩"""
        strain = self.Cc / (1 + self.e0) * np.log10(sigma_f / sigma_0)
        return strain * self.thickness
```python

### 沉降模型

```python
class SubsidenceModel:
    """沉降模型"""
    def __init__(self):
        self.layers = []
    
    def add_layer(self, layer):
        self.layers.append(layer)
    
    def compute_subsidence(self, head_changes):
        """计算总沉降"""
        total = 0
        for layer in self.layers:
            dh = head_changes[layer.name]
            ds = compute_effective_stress_change(dh)
            comp = layer.compute_compression_linear(ds)
            total += comp
        return total
```python

### 固结度计算

```python
def consolidation_degree(Tv):
    """平均固结度U(Tv)"""
    U = 0
    for m in range(20):
        M = np.pi * (2*m + 1) / 2
        U += (2 / M**2) * np.exp(-M**2 * Tv)
    U = 1 - U
    return U

# 示例
Cv, H, t = 1.0, 5.0, 100  # m²/day, m, day
Tv = Cv * t / H**2
U = consolidation_degree(Tv)
print(f"固结度: {U*100:.1f}%")
```python

---

## 📊 运行案例

### 执行命令

```bash
cd code/examples/case_17
python3 case_17_subsidence.py
```python

### 预期输出（节选）

```
============================================================
案例17：地面沉降模拟
============================================================

实验1：Terzaghi有效应力原理
============================================================

有效应力变化计算：
水位变化(m)      有效应力增量(kPa)   
-----------------------------------
0.0             0.0                 
-5.0            49.1                
-10.0           98.1                
-15.0           147.2               
-20.0           196.2               
-30.0           294.3               

物理解释：
  水位下降 → 孔隙水压力降低
  总应力不变 → 有效应力增加
  有效应力增加 → 土层压缩

实验2：线性vs对数压缩模型
============================================================

线性模型：
  ΔH = av * Δσ' * H
  av = 0.0005 1/kPa
  Δσ'=100kPa → ΔH=0.500m

对数模型：
  ΔH/H = Cc/(1+e0) * log10(σ'f/σ'0)
  Cc = 0.3, e0 = 0.8
  σ'0=100kPa, σ'f=200kPa → ΔH=0.167m

实验3：正常固结 vs 超固结
============================================================

正常固结（NC）：
  σ'0 = σ'c = 100 kPa
  一直处于正常压缩状态
  σ'f=300kPa → ΔH=0.419m

超固结（OC）：
  σ'0 = 100 kPa < σ'c = 200 kPa
  历史上经历过更大应力
  σ'f<σ'c：再压缩（小压缩）
  σ'f>σ'c：正常压缩（大压缩）
  σ'f=300kPa → ΔH=0.194m

超固结比 OCR = σ'c / σ'0 = 2.0
  OCR=1: 正常固结
  OCR>1: 超固结（压缩小）

实验4：固结时间过程
============================================================

参数：
  土层厚度: 10 m（双面排水）
  排水距离 H: 5 m
  固结系数 Cv: 1.0 m²/day
  最终沉降: 0.5 m

关键时间点：
  U=50% (S=0.25m): t=4.9 day (0.01 year)
  U=90% (S=0.45m): t=21.2 day (0.06 year)
  U=95% (S=0.48m): t=28.2 day (0.08 year)

实验5：多层系统总沉降
============================================================

土层结构：
层名          厚度(m)    av(1/kPa)    Cv(m²/day)  
--------------------------------------------------
填土          3.0        0.000200     5.00        
粉质粘土      7.0        0.000300     2.00        
淤泥质粘土    10.0       0.000800     0.50        
粘土          15.0       0.000400     1.00        
砂层          15.0       0.000050     50.00       

总厚度: 50.0 m

水位下降: 30 m

各层压缩量：
层名          压缩量(m)    贡献率(%)   
----------------------------------------
填土          0.0265       5.3         
粉质粘土      0.0618       12.4        
淤泥质粘土    0.2354       47.2        
粘土          0.1767       35.4        
砂层          0.0022       0.4         

总沉降: 0.499 m = 49.9 cm

分析：
  淤泥质粘土贡献最大（高压缩性）
  砂层几乎不压缩（低压缩性）
  总沉降是各层叠加

✅ 案例17执行完成！
```matlab

### 生成图片

程序会生成 `case_17_subsidence_results.png`，包含9个子图：

1. **Terzaghi有效应力原理**（水位-应力关系）
2. **压缩模型对比**（线性vs对数）
3. **正常固结vs超固结**
4. **固结度vs时间**
5. **沉降时间曲线**
6. **各层压缩量**（柱状图）
7. **土层剖面**
8. **沉降漏斗2D**
9. **降深与沉降剖面**

---

## 📈 结果分析

### 1. 有效应力原理

**关系**：
- 线性关系：Δσ' = 9.81 kPa/m
- 水位降30m → 应力增294 kPa

**意义**：
- 简单直接的关系
- 易于估算
- 是沉降计算的基础

### 2. 压缩模型

**线性模型**：
- 简单，适合小应力增量
- 工程常用
- 保守估计

**对数模型**：
- 更符合实际
- 适合大应力范围
- 科研推荐

### 3. 先期固结影响

**超固结土优势**：
- 压缩性小（约NC的50%）
- 沉降小
- 承载力高

**原因**：
- 历史上被压过
- 土结构密实
- 再压缩段斜率小（Cs << Cc）

### 4. 固结时间

**特征**：
- U=50%：快速（几天）
- U=90%：较长（几周）
- U=95%以上：很慢（渐近）

**工程意义**：
- 沉降不是瞬时的
- 需要时间预测
- 监测很重要

**影响因素**：
- Cv大 → 快（砂土）
- Cv小 → 慢（粘土）
- H大 → 慢

### 5. 多层系统

**贡献分析**：
- 淤泥质粘土：47%（高av）
- 粘土：35%
- 砂层：<1%（低av）

**关键层**：
- 识别高压缩性层
- 重点调查
- 针对性防治

### 6. 沉降空间分布

**特征**：
- 井附近沉降大
- 形成沉降漏斗
- 范围与降深范围一致

**工程问题**：
- 差异沉降（建筑物倾斜）
- 地裂缝（沉降梯度大）

---

## 🔬 实验探索

### 实验1: 不同土质的沉降对比

**目标**：量化土质对沉降的影响

```python
soil_types = {
    '砂土': {'av': 0.0002},
    '粉土': {'av': 0.0006},
    '粘土': {'av': 0.001},
    '淤泥': {'av': 0.005}
}

for name, params in soil_types.items():
    layer = SoilLayer(name, 0, -10, av=params['av'])
    comp = layer.compute_compression_linear(294.3)  # 30m降深
    print(f"{name}: {comp*100:.1f} cm")
```python

**预期**：
- 砂土：~5cm
- 淤泥：>100cm
- 差异巨大

### 实验2: Cv对固结时间的影响

**目标**：理解Cv的重要性

```python
Cv_range = [0.1, 0.5, 1.0, 5.0, 10.0]  # m²/day

for Cv in Cv_range:
    t50 = 0.197 * H**2 / Cv
    print(f"Cv={Cv}: t50={t50:.1f} day")
```python

**预期**：
- Cv↑10倍 → t↓10倍
- 砂土快，粘土慢

### 实验3: 排水条件影响

**目标**：对比单面vs双面排水

```python
# 双面排水
H_double = layer_thickness / 2

# 单面排水
H_single = layer_thickness

# 时间比
time_ratio = (H_single / H_double)**2  # = 4
```python

**预期**：
- 单面排水时间是双面的4倍

### 实验4: 分层沉降监测设计

**目标**：设计分层沉降计

```python
# 在不同深度设置监测点
depths = [3, 10, 20, 35, 50]  # m

for d in depths:
    # 预测该深度的沉降
    # 设计监测频率
```

---

## 🤔 常见问题

### Q1: 为什么要分正常固结和超固结？

**A**: 压缩性差异巨大

**正常固结**：
- 从未被大应力压过
- 结构松散
- 压缩性大（Cc）

**超固结**：
- 历史上被压过（冰川、剥蚀、地下水位变化）
- 结构密实
- 压缩性小（Cs ≈ Cc/5）

**工程意义**：
- OCR=1: 沉降大，需警惕
- OCR>2: 沉降小，较安全

**判别方法**：
- 室内试验（固结试验）
- 原位测试（CPT等）
- 地质历史分析

### Q2: 如何确定先期固结压力σ'c？

**A**: 多种方法

**1. Casagrande作图法**：
- e-logσ'曲线
- 找拐点
- 最常用

**2. Schmertmann法**：
- 双对数法
- 适合超固结比大的土

**3. 经验估计**：
- OCR ≈ (深度/10)^0.5  （粗略）

**4. 地质历史**：
- 剥蚀厚度
- 地下水位历史
- 冰川荷载

### Q3: 线性模型还是对数模型？

**A**: 视情况而定

**用线性模型**：
- 应力增量小（<50kPa）
- 初步估算
- 保守设计
- 计算简便

**用对数模型**：
- 应力增量大（>100kPa）
- 精细计算
- 科研分析
- 更符合实际

**对比**：
- 小应力：两者接近
- 大应力：对数更准确
- 工程设计：线性偏安全

### Q4: 如何加速固结？

**A**: 工程措施

**1. 砂井/塑料排水板**：
- 缩短排水距离
- H ↓ → Tv ↑ → t ↓
- 效果显著

**2. 堆载预压**：
- 提前加载
- 完成大部分沉降
- 工后残余沉降小

**3. 真空预压**：
- 负压吸水
- 加速固结
- 无需大量填料

**4. 电渗法**：
- 通电排水
- 适合低渗透土
- 成本高

### Q5: 沉降如何监测？

**A**: 多层次监测

**地表沉降**：
- 水准测量
- GPS
- InSAR（卫星）

**分层沉降**：
- 分层沉降计
- 识别沉降层位
- 验证模型

**孔隙水压力**：
- 孔压计
- 监测固结过程
- 评估排水条件

**地下水位**：
- 观测井
- 识别根本原因
- 控制措施效果

**频率**：
- 施工期：周/月
- 稳定期：月/季/年

---

## 📚 扩展阅读

### 经典文献

1. **Terzaghi, K. (1923)**. "Die Berechnung der Durchassigkeitsziffer des Tones aus dem Verlauf der hydrodynamischen Spannungserscheinungen". Sitzungsber. Akad. Wiss. Wien, Math.-Naturwiss. Kl., Abt. IIa, 132: 125–138.
   - 有效应力原理
   - 固结理论

2. **Terzaghi, K. (1925)**. Erdbaumechanik auf bodenphysikalischer Grundlage. Deuticke, Vienna.
   - 土力学奠基作

3. **Casagrande, A. (1936)**. "The determination of the pre-consolidation load and its practical significance". Proc. 1st ICSMFE, 3: 60–64.
   - 先期固结压力确定

### 沉降案例研究

1. **墨西哥城**：
   - 累计沉降>10m
   - 软粘土厚层
   - 过度开采

2. **威尼斯**：
   - 沉降+海平面上升
   - 工业抽水
   - MOSE工程

3. **上海**：
   - 沉降速率控制
   - 分层开采
   - 回灌补救

### 教材推荐

1. **Lambe, T.W. and Whitman, R.V. (1969)**. Soil Mechanics. Wiley.
   - 第11章：Consolidation
   - 经典教材

2. **Holtz, R.D. et al. (2011)**. An Introduction to Geotechnical Engineering (2nd ed.).
   - 第10章：Compressibility and Settlement

3. **中国规范**：
   - GB 50007 建筑地基基础设计规范
   - 沉降计算方法

---

## ✅ 学习检查

完成本案例后，你应该能够：

- [ ] 解释Terzaghi有效应力原理
- [ ] 计算水位变化引起的应力变化
- [ ] 应用线性和对数压缩模型
- [ ] 理解先期固结概念
- [ ] 区分正常固结和超固结土
- [ ] 计算固结时间过程
- [ ] 预测多层系统总沉降
- [ ] 分析沉降空间分布
- [ ] 评估沉降风险
- [ ] 提出控制措施

---

## 🚀 下一步

**案例18：污染物运移模拟**

将学习：
- 对流-弥散方程
- 吸附与衰减
- 污染羽演化
- 修复方案设计

**关键内容**：
地下水污染事故 → 污染物在地下水中运移 → 预测污染羽 → 设计修复方案

**最后一个案例！** 💪

---

**Happy Subsidence Modeling! 📉🏗️**
