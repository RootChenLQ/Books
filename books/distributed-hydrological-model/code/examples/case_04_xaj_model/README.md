# 案例4：新安江模型产流计算

## 系统示意图（AI自动生成）

<table>
<tr>
<td width="58%">
<img src="case_04_xaj_model_ai_diagram.png" alt="案例4：新安江模型产流计算系统示意图" width="100%"/>
</td>
<td width="42%">

**AI大模型总结要点**

- 📖 案例背景：新安江模型是中国应用最广泛的流域水文模型，由河海大学赵人俊院士于1973年提出。本案例以某典型湿润地区流域为例，详细讲解新安江模型的产流计算原理和Python实现。
- 🎯 学习目标：理解新安江模型的蓄满产流机制
- 📊 数据说明：流域特征**:
- 🔬 理论基础：蓄满产流

> 该图由AI图像生成引擎根据案例描述自动创建，呈现输入条件、物理模型、控制策略与关键指标之间的关系，可作为阅读正文前的快速导览。

</td>
</tr>
</table>



## 📖 案例背景

新安江模型是中国应用最广泛的流域水文模型，由河海大学赵人俊院士于1973年提出。本案例以某典型湿润地区流域为例，详细讲解新安江模型的产流计算原理和Python实现。

## 🎯 学习目标

1. 理解新安江模型的蓄满产流机制
2. 掌握三层蒸散发计算方法
3. 理解三水源划分原理
4. 学会Python实现水文模型
5. 掌握模型参数敏感性分析

## 📊 数据说明

**流域特征**:
- 流域面积: 1200 km²
- 流域类型: 湿润地区
- 气候类型: 亚热带季风气候

**输入数据**:
- 逐日降雨: 365天 (mm)
- 逐日蒸发能力: 365天 (mm)

**输出结果**:
- 径流深过程线
- 三水源分量
- 土壤含水量变化
- 自由水储量变化

## 🔬 理论基础

### 1. 蓄满产流

新安江模型采用蓄满产流机制：

```python
当土壤含水量达到田间持水量时才产流
产流量 = 降雨量 - 蓄水容量亏缺
```

**蓄水容量曲线**（抛物线分布）:
```python
f = WM * (1 - (1 - A/Am)^β)
```

其中：
- f: 蓄水容量曲线纵坐标
- WM: 流域平均蓄水容量
- A: 横坐标（已蓄满面积对应的蓄水容量）
- β: 蓄水容量曲线指数

### 2. 三层蒸散发

- **上层**: 主要植物蒸腾
- **下层**: 深根系吸水
- **深层**: 地下水蒸发

### 3. 三水源划分

- **地表径流** (RS): 快速响应
- **壤中流** (RI): 中等响应
- **地下径流** (RG): 缓慢响应

## 🚀 快速开始

### 运行模拟

```bash
python main.py
```python

### 查看结果

```bash
ls outputs/
# hydrograph.png - 水文过程线
# water_sources.png - 三水源分量图
# soil_moisture.png - 土壤含水量变化
# sensitivity_analysis.png - 参数敏感性分析
```matlab

## 📈 实验内容

### 实验1：基础模拟
运行新安江模型，观察径流过程

### 实验2：参数敏感性分析
改变关键参数（WM, B, SM等），分析对结果的影响

### 实验3：三水源分析
分析不同水源的响应特征和时间分布

### 实验4：蓄水容量曲线
绘制不同B值下的f-A关系曲线

## 📊 预期结果

### 模型性能指标
- Nash效率系数 (NSE): > 0.7
- 相对误差 (RE): < 10%
- 洪峰相对误差 (PE): < 15%

### 水量平衡
```
降雨 = 蒸散发 + 径流 + 蓄水变化
P = E + R + ΔW
```

## 🔧 参数说明

### 蒸散发参数
- K: 蒸发折算系数 (0.7-1.2)
- UM: 上层蓄水容量 (10-20 mm)
- LM: 下层蓄水容量 (60-90 mm)
- C: 深层蒸散发系数 (0.1-0.3)

### 产流参数
- WM: 流域平均蓄水容量 (100-200 mm)
- B: 蓄水容量曲线指数 (0.1-0.4)
- IM: 不透水面积占比 (0.0-0.05)

### 水源划分参数
- SM: 自由水蓄水库容量 (10-50 mm)
- EX: 自由水蓄水库出流指数 (1.0-1.5)
- KG: 地下水出流系数 (0.3-0.7)
- KI: 壤中流出流系数 (0.3-0.7)

## 📚 参考文献

1. 赵人俊, 王佩兰. 新安江模型参数的分析. 水文, 1988.
2. 李致家, 等. 新安江模型原理与应用. 河海大学出版社, 2005.
3. Zhao, R.J., et al. The Xinanjiang model applied in China. Journal of Hydrology, 1992.

## 💡 提示

1. 参数率定是关键，不同流域参数差异很大
2. B参数对产流影响显著，需要仔细率定
3. 三水源的消退系数决定了洪水过程的形态
4. 实际应用中需要配合汇流计算

---

**难度**: ⭐⭐  
**所需时间**: 2-3小时  
**前置知识**: Python基础、水文学基础
